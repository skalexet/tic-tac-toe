const matrix=[];let clickable;const engine=(e,t,n)=>matrix[e][t]==n,win=e=>{dialogWindow(`${e} has won`)},restart=()=>{document.querySelector("tbody").remove();for(document.querySelector("div").remove();matrix.length>0;)matrix.pop();install()},dialogWindow=e=>{const t=document.createElement("div"),n=document.createElement("span"),r=document.createElement("button");n.innerText=e,r.innerText="X",r.addEventListener("click",restart),t.appendChild(n),t.appendChild(r),document.body.appendChild(t)},checkForCats=()=>{let e=0;for(let t of matrix)e+=t.includes(0)?1:0;return 0===e&&(dialogWindow("Cat's game :3"),!0)},checkScores=(e,t)=>e<3?1:(win(t),!1),score=(e,t,n)=>{let r=0,o=e,c=t;for(r++;++o<matrix.length;)engine(o,c,n)&&r++;for(o=e;--o>=0;)engine(o,c,n)&&r++;if(o=e,r=checkScores(r,n)){for(;--c>=0;)engine(o,c,n)&&r++;for(c=t;matrix[o].length>++c;)engine(o,c,n)&&r++;if(c=t,r=checkScores(r,n)){for(;++c>=0&&++o<matrix.length;)engine(o,c,n)&&r++;for(o=e,c=t;--c>=0&&--o>=0;)engine(o,c,n)&&r++;if(o=e,c=t,r=checkScores(r,n)){for(;++c<matrix.length&&--o>=0;)engine(o,c,n)&&r++;for(o=e,c=t;--c>=0&&++o<matrix.length;)engine(o,c,n)&&r++;o=e,c=t,(r=checkScores(r,n))&&(checkForCats()||(clickable=!0))}}}};function opposite(e,t){clickable&&(clickable=!1,setTimeout((()=>{for(;"X"==matrix[e][t]||"O"==matrix[e][t];)e=Math.floor(3*Math.random()),t=Math.floor(3*Math.random());matrix[e][t]="O",score(e,t,"O"),drawO(e,t)}),750))}function controller(e,t,n){"X"!=matrix[t][n]&&"O"!=matrix[t][n]&&clickable&&(clickable=!1,matrix[t][n]="X",e.innerText="X",e.style.color="red",score(t,n,"X"),opposite(t,n))}function drawO(e,t){document.querySelectorAll("tr")[e].querySelectorAll("td")[t].innerText="O"}function install(){const e=document.querySelector("table"),t=document.createElement("tbody");for(let r=0;r<3;r++)matrix.push([0,0,0]);for(let o=0;o<3;o++){const c=document.createElement("tr");for(let i=0;i<3;i++){const l=document.createElement("td");function n(e){controller(e.target,o,i)}l.addEventListener("click",n),c.appendChild(l)}t.appendChild(c)}e.appendChild(t),clickable=!0}install();